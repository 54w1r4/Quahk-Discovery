<!DOCTYPE html>
<html>
    <head>
        <title>formAPI Test</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no,  target-densityDpi=device-dpi" />
        <meta http-equiv='Content-Type' content='text/html, charset=utf-8' />
        <style>
            .shopBlock {
                border: 1.5px solid black;
                padding: 5%;
            }
        </style>
    </head>
   
    
    <body onload="checkStorage()">
        <input type="checkbox" id="cloud1" onclick="changeCloudStatus()">
        <label for="cloud1"> Cloud Saving</label><br>
    <form id="ricky">
       
        <p>Email</p>    
        <input type="email" name="email"  />
        <p>Message</p>
        <textarea type="text" name="message"></textarea><br>
        <input type="file" id="img" name="img" accept="image/*" /><br><br>
        <input type="submit" value="submit" id="submitBtn" onclick="localSave()"/>

    </form>
    <br>
    <div class="shopBlock">
        <h3>Shop1</h3>
        <hr>
        <p>你的意見：</p>
    </div>

    <p id="demo"></p>

    <script>
        function changeCloudStatus() {
            var checkBox = document.querySelector("#cloud1");
            if (checkBox.checked == true) {
                localStorage.cloudSaving = true;
                alert("Cloud Saving has been turned on.");
            } else if (checkBox.checked == false) {
                localStorage.cloudSaving = false;
                alert("Cloud Saving has been disabled.");
            }
        }


        function checkStorage() {
            if (typeof (Storage) !== "undefined") {
                // Code for localStorage/sessionStorage.
                var localCases = {'title': 'abc', 'msg': 'hello world'};

                // Put the object into storage
                localStorage.setItem('cases', JSON.stringify(localCases));

               if (localStorage.cases == "") {
                   console.log("doesn't exists");
               } else {
                   var i;
                   var casesArray = JSON.parse(localStorage.getItem("cases"));
                   for (i == 0; i < 5; i++) {

                   };
               }
               
                //localStorage.cloudSaving = false;
                //localStorage.message = document.querySelector("#message");
            } else {
                // Sorry! No Web Storage support..
                alert("Sorry! Your browser don't support Local Storage \nSo, you can only use cloud saving.");
                document.querySelector("#submitBtn").removeAttribute("onclick");
                document.getElementById("ricky").setAttribute("action", "https://us-central1-quahk-competition-3rdmwdsc.cloudfunctions.net/formSubmit");
                document.getElementById("ricky").setAttribute("method", "POST");
                document.getElementById("cloud1").setAttribute("disabled", "");
                document.getElementById("cloud1").setAttribute("checked", "");
                
            }
        }
    </script>

    </body>
</html>